0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> USE team3_projectdb;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> SET hive.exec.dynamic.partition=true;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> SET hive.execution.engine=tez;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> SET hive.exec.dynamic.partition.mode=nonstrict;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> CREATE EXTERNAL TABLE sensor_readings_part_buck(
. . . . . . . . . . . . . . . . . . . . . . .>     index INT,
. . . . . . . . . . . . . . . . . . . . . . .>     `timestamp` STRING,
. . . . . . . . . . . . . . . . . . . . . . .>     TP2 DOUBLE,
. . . . . . . . . . . . . . . . . . . . . . .>     TP3 DOUBLE,
. . . . . . . . . . . . . . . . . . . . . . .>     H1 DOUBLE,
. . . . . . . . . . . . . . . . . . . . . . .>     DV_pressure DOUBLE,
. . . . . . . . . . . . . . . . . . . . . . .>     Reservoirs DOUBLE,
. . . . . . . . . . . . . . . . . . . . . . .>     Oil_temperature DOUBLE,
. . . . . . . . . . . . . . . . . . . . . . .>     Motor_current DOUBLE,
. . . . . . . . . . . . . . . . . . . . . . .>     COMP DOUBLE,
. . . . . . . . . . . . . . . . . . . . . . .>     DV_eletric DOUBLE,
. . . . . . . . . . . . . . . . . . . . . . .>     Towers DOUBLE,
. . . . . . . . . . . . . . . . . . . . . . .>     MPG DOUBLE,
. . . . . . . . . . . . . . . . . . . . . . .>     LPS DOUBLE,
. . . . . . . . . . . . . . . . . . . . . . .>     Pressure_switch DOUBLE,
. . . . . . . . . . . . . . . . . . . . . . .>     Oil_level DOUBLE,
. . . . . . . . . . . . . . . . . . . . . . .>     Caudal_impulses DOUBLE
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> PARTITIONED BY (timestamp_month STRING)
. . . . . . . . . . . . . . . . . . . . . . .> CLUSTERED BY (index) into 7 buckets
. . . . . . . . . . . . . . . . . . . . . . .> STORED AS AVRO LOCATION '/user/team3/project/warehouse/sensor_readings_part_buck'
. . . . . . . . . . . . . . . . . . . . . . .> TBLPROPERTIES ('AVRO.COMPRESS'='SNAPPY');
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> INSERT INTO TABLE sensor_readings_part_buck PARTITION (timestamp_month)
. . . . . . . . . . . . . . . . . . . . . . .> SELECT *, month(TO_DATE(`timestamp`)) as timestamp_month
. . . . . . . . . . . . . . . . . . . . . . .> FROM sensor_readings;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> SELECT * FROM sensor_readings_part_buck LIMIT 10;
+----------------------------------+--------------------------------------+--------------------------------+--------------------------------+-------------------------------+----------------------------------------+---------------------------------------+--------------------------------------------+------------------------------------------+---------------------------------+---------------------------------------+-----------------------------------+--------------------------------+--------------------------------+--------------------------------------------+--------------------------------------+--------------------------------------------+--------------------------------------------+
| sensor_readings_part_buck.index  | sensor_readings_part_buck.timestamp  | sensor_readings_part_buck.tp2  | sensor_readings_part_buck.tp3  | sensor_readings_part_buck.h1  | sensor_readings_part_buck.dv_pressure  | sensor_readings_part_buck.reservoirs  | sensor_readings_part_buck.oil_temperature  | sensor_readings_part_buck.motor_current  | sensor_readings_part_buck.comp  | sensor_readings_part_buck.dv_eletric  | sensor_readings_part_buck.towers  | sensor_readings_part_buck.mpg  | sensor_readings_part_buck.lps  | sensor_readings_part_buck.pressure_switch  | sensor_readings_part_buck.oil_level  | sensor_readings_part_buck.caudal_impulses  | sensor_readings_part_buck.timestamp_month  |
+----------------------------------+--------------------------------------+--------------------------------+--------------------------------+-------------------------------+----------------------------------------+---------------------------------------+--------------------------------------------+------------------------------------------+---------------------------------+---------------------------------------+-----------------------------------+--------------------------------+--------------------------------+--------------------------------------------+--------------------------------------+--------------------------------------------+--------------------------------------------+
| 1695270                          | 2020-02-23 06:26:09                  | -0.0120000000000004            | 9.4                            | 9.386000000000001             | -0.0199999999999995                    | 9.402000000000001                     | 55.0                                       | 0.04                                     | 1.0                             | 0.0                                   | 1.0                               | 1.0                            | 0.0                            | 1.0                                        | 1.0                                  | 1.0                                        | 2                                          |
| 1695250                          | 2020-02-23 06:25:49                  | -0.0120000000000004            | 9.416                          | 9.402000000000001             | -0.0199999999999995                    | 9.418                                 | 54.925                                     | 0.04                                     | 1.0                             | 0.0                                   | 1.0                               | 1.0                            | 0.0                            | 1.0                                        | 1.0                                  | 1.0                                        | 2                                          |
| 1695200                          | 2020-02-23 06:24:59                  | -0.0120000000000004            | 9.456                          | 9.437999999999999             | -0.0219999999999984                    | 9.458                                 | 54.925                                     | 0.0375000000000005                       | 1.0                             | 0.0                                   | 1.0                               | 1.0                            | 0.0                            | 1.0                                        | 1.0                                  | 1.0                                        | 2                                          |
| 1695090                          | 2020-02-23 06:23:10                  | -0.0120000000000004            | 9.54                           | 9.524                         | -0.0219999999999984                    | 9.542                                 | 54.95000000000002                          | 0.04                                     | 1.0                             | 0.0                                   | 1.0                               | 1.0                            | 0.0                            | 1.0                                        | 1.0                                  | 1.0                                        | 2                                          |
| 1695030                          | 2020-02-23 06:22:11                  | -0.0120000000000004            | 9.584                          | 9.568                         | -0.0219999999999984                    | 9.586                                 | 54.82499999999999                          | 0.04                                     | 1.0                             | 0.0                                   | 1.0                               | 1.0                            | 0.0                            | 1.0                                        | 1.0                                  | 1.0                                        | 2                                          |
| 1695020                          | 2020-02-23 06:22:01                  | -0.0120000000000004            | 9.588                          | 9.576                         | -0.0199999999999995                    | 9.592                                 | 54.75000000000002                          | 0.04                                     | 1.0                             | 0.0                                   | 1.0                               | 1.0                            | 0.0                            | 1.0                                        | 1.0                                  | 1.0                                        | 2                                          |
| 1694980                          | 2020-02-23 06:21:21                  | -0.009999999999998002          | 9.622                          | 9.607999999999999             | -0.0199999999999995                    | 9.624                                 | 54.0                                       | 3.8000000000000007                       | 1.0                             | 0.0                                   | 1.0                               | 1.0                            | 0.0                            | 1.0                                        | 1.0                                  | 1.0                                        | 2                                          |
| 1694970                          | 2020-02-23 06:21:11                  | -0.0120000000000004            | 9.628                          | 9.613999999999999             | -0.0199999999999995                    | 9.63                                  | 53.89999999999999                          | 3.754999999999999                        | 1.0                             | 0.0                                   | 1.0                               | 1.0                            | 0.0                            | 1.0                                        | 1.0                                  | 1.0                                        | 2                                          |
| 1694960                          | 2020-02-23 06:21:02                  | -0.009999999999998002          | 9.636000000000001              | 9.622                         | -0.0199999999999995                    | 9.638                                 | 53.95                                      | 3.7775                                   | 1.0                             | 0.0                                   | 1.0                               | 1.0                            | 0.0                            | 1.0                                        | 1.0                                  | 1.0                                        | 2                                          |
| 1694840                          | 2020-02-23 06:19:03                  | -0.009999999999998002          | 9.73                           | 9.716000000000001             | -0.0219999999999984                    | 9.732000000000001                     | 54.125                                     | 3.815                                    | 1.0                             | 0.0                                   | 1.0                               | 1.0                            | 0.0                            | 1.0                                        | 1.0                                  | 1.0                                        | 2                                          |
+----------------------------------+--------------------------------------+--------------------------------+--------------------------------+-------------------------------+----------------------------------------+---------------------------------------+--------------------------------------------+------------------------------------------+---------------------------------+---------------------------------------+-----------------------------------+--------------------------------+--------------------------------+--------------------------------------------+--------------------------------------+--------------------------------------------+--------------------------------------------+
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> DROP TABLE sensor_readings;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 